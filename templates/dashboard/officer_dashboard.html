<div class="grid">
    <div class="card">
        <h3>Overview</h3>
        <div class="metric-lg">{{ stats.region }} Region</div>
        <p>Assigned Farmers: <strong>{{ stats.assigned_farmers }}</strong></p>
        <p>Pending Visits: <strong>{{ stats.pending_visits }}</strong></p>
    </div>

    <div class="card alert-card">
        <h3>‚ö†Ô∏è Active Alerts</h3>
        <ul class="list">
            {% for alert in recent_alerts %}
            <li>{{ alert }}</li>
            {% endfor %}
        </ul>
        <a class="btn btn-accent" style="width: 100%; margin-top: 1rem;" href="{% url 'extension_inquiries' %}">View Ask Queue</a>
    </div>
    <div class="card">
        <h3>Queues</h3>
        <div class="stacked">
            <div class="pill">
                <strong>New Questions</strong>
                <span class="badge">{{ inquiry_count|default:0 }}</span>
            </div>
            <div class="pill">
                <strong>Open Follow-ups</strong>
                <span class="badge">{{ followup_count|default:0 }}</span>
            </div>
        </div>
    </div>
</div>

<div class="grid">
    <div class="card">
        <h3>üåæ Regional Crop Distribution</h3>
        <canvas id="cropChart" style="max-height: 360px;"></canvas>
    </div>
    <div class="card">
        <h3>Extension Tools</h3>
        <p class="muted">Jump into the tools you use most.</p>
        <div class="stacked">
            <a class="btn btn-secondary" href="{% url 'extension_dashboard' %}">Extension Dashboard</a>
            <a class="btn btn-secondary" href="{% url 'extension_inquiries' %}">Ask Queue</a>
            <a class="btn btn-secondary" href="{% url 'extension_followups' %}">Follow-ups</a>
            <a class="btn btn-secondary" href="{% url 'extension_soil' %}">Soil Tests</a>
            <a class="btn btn-secondary" href="{% url 'extension_yield' %}">Yields</a>
            <a class="btn btn-secondary" href="{% url 'extension_groups' %}">Farmer Groups</a>
            <a class="btn btn-secondary" href="{% url 'extension_traceability' %}">Traceability</a>
            <a class="btn btn-secondary" href="{% url 'extension_compliance' %}">GAP/Organic</a>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const ctx = document.getElementById('cropChart').getContext('2d');
    new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: ['Maize', 'Tea', 'Coffee', 'Horticulture'],
            datasets: [{
                label: 'Farmers Cultivating',
                data: [45, 25, 20, 10],
                backgroundColor: [
                    '#FFD54F',
                    '#66BB6A',
                    '#8D6E63',
                    '#AB47BC'
                ],
                hoverOffset: 4
            }]
        }
    });
</script>